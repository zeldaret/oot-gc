glabel mcardReplaceFileBlock
/* 0161F4 8001B794 7C0802A6 */  mflr    r0
/* 0161F8 8001B798 38A02000 */  li      r5, 0x2000
/* 0161FC 8001B79C 90010004 */  stw     r0, 4(r1)
/* 016200 8001B7A0 9421DDA8 */  stwu    r1, -0x2258(r1)
/* 016204 8001B7A4 BF612244 */  stmw    r27, 0x2244(r1)
/* 016208 8001B7A8 3BA40000 */  addi    r29, r4, 0
/* 01620C 8001B7AC 3B830000 */  addi    r28, r3, 0
/* 016210 8001B7B0 80830474 */  lwz     r4, 0x474(r3)
/* 016214 8001B7B4 38610238 */  addi    r3, r1, 0x238
/* 016218 8001B7B8 4BFE9D0D */  bl      memcpy
/* 01621C 8001B7BC 3C608010 */  lis     r3, mCard@ha
/* 016220 8001B7C0 837C0474 */  lwz     r27, 0x474(r28)
/* 016224 8001B7C4 386379B0 */  addi    r3, r3, mCard@l
/* 016228 8001B7C8 3BE30470 */  addi    r31, r3, 0x470
/* 01622C 8001B7CC 80030470 */  lwz     r0, 0x470(r3)
/* 016230 8001B7D0 2C000001 */  cmpwi   r0, 1
/* 016234 8001B7D4 4082005C */  bne     lbl_8001B830
/* 016238 8001B7D8 389B0000 */  addi    r4, r27, 0
/* 01623C 8001B7DC 387C0348 */  addi    r3, r28, 0x348
/* 016240 8001B7E0 38A02000 */  li      r5, 0x2000
/* 016244 8001B7E4 38C04000 */  li      r6, 0x4000
/* 016248 8001B7E8 38E00000 */  li      r7, 0
/* 01624C 8001B7EC 480A51E5 */  bl      CARDReadAsync
/* 016250 8001B7F0 38830000 */  addi    r4, r3, 0
/* 016254 8001B7F4 387C0000 */  addi    r3, r28, 0
/* 016258 8001B7F8 48000AA9 */  bl      mcardGCErrorHandler
/* 01625C 8001B7FC 2C030001 */  cmpwi   r3, 1
/* 016260 8001B800 4182000C */  beq     lbl_8001B80C
/* 016264 8001B804 38000000 */  li      r0, 0
/* 016268 8001B808 4800002C */  b       lbl_8001B834
lbl_8001B80C:
/* 01626C 8001B80C 7F83E378 */  mr      r3, r28
/* 016270 8001B810 4BFFF959 */  bl      mcardPoll
/* 016274 8001B814 2C030001 */  cmpwi   r3, 1
/* 016278 8001B818 4182000C */  beq     lbl_8001B824
/* 01627C 8001B81C 38000000 */  li      r0, 0
/* 016280 8001B820 48000014 */  b       lbl_8001B834
lbl_8001B824:
/* 016284 8001B824 387B0000 */  addi    r3, r27, 0
/* 016288 8001B828 38802000 */  li      r4, 0x2000
/* 01628C 8001B82C 48081F25 */  bl      DCInvalidateRange
lbl_8001B830:
/* 016290 8001B830 38000001 */  li      r0, 1
lbl_8001B834:
/* 016294 8001B834 2C000000 */  cmpwi   r0, 0
/* 016298 8001B838 4082000C */  bne     lbl_8001B844
/* 01629C 8001B83C 38600000 */  li      r3, 0
/* 0162A0 8001B840 480003C0 */  b       lbl_8001BC00
lbl_8001B844:
/* 0162A4 8001B844 2C1D0000 */  cmpwi   r29, 0
/* 0162A8 8001B848 4082012C */  bne     lbl_8001B974
/* 0162AC 8001B84C 809C0474 */  lwz     r4, 0x474(r28)
/* 0162B0 8001B850 38612238 */  addi    r3, r1, 0x2238
/* 0162B4 8001B854 38A00004 */  li      r5, 4
/* 0162B8 8001B858 38840028 */  addi    r4, r4, 0x28
/* 0162BC 8001B85C 4BFE9C69 */  bl      memcpy
/* 0162C0 8001B860 801F0000 */  lwz     r0, 0(r31)
/* 0162C4 8001B864 2C000001 */  cmpwi   r0, 1
/* 0162C8 8001B868 40820230 */  bne     lbl_8001BA98
/* 0162CC 8001B86C 38000100 */  li      r0, 0x100
/* 0162D0 8001B870 38800000 */  li      r4, 0
/* 0162D4 8001B874 7C0903A6 */  mtctr   r0
/* 0162D8 8001B878 38A40000 */  addi    r5, r4, 0
/* 0162DC 8001B87C 3BC00000 */  li      r30, 0
lbl_8001B880:
/* 0162E0 8001B880 2804000A */  cmplwi  r4, 0xa
/* 0162E4 8001B884 41820010 */  beq     lbl_8001B894
/* 0162E8 8001B888 807C0474 */  lwz     r3, 0x474(r28)
/* 0162EC 8001B88C 7C03282E */  lwzx    r0, r3, r5
/* 0162F0 8001B890 7FDE0214 */  add     r30, r30, r0
lbl_8001B894:
/* 0162F4 8001B894 38840001 */  addi    r4, r4, 1
/* 0162F8 8001B898 2804000A */  cmplwi  r4, 0xa
/* 0162FC 8001B89C 38A50004 */  addi    r5, r5, 4
/* 016300 8001B8A0 41820010 */  beq     lbl_8001B8B0
/* 016304 8001B8A4 807C0474 */  lwz     r3, 0x474(r28)
/* 016308 8001B8A8 7C03282E */  lwzx    r0, r3, r5
/* 01630C 8001B8AC 7FDE0214 */  add     r30, r30, r0
lbl_8001B8B0:
/* 016310 8001B8B0 38840001 */  addi    r4, r4, 1
/* 016314 8001B8B4 2804000A */  cmplwi  r4, 0xa
/* 016318 8001B8B8 38A50004 */  addi    r5, r5, 4
/* 01631C 8001B8BC 41820010 */  beq     lbl_8001B8CC
/* 016320 8001B8C0 807C0474 */  lwz     r3, 0x474(r28)
/* 016324 8001B8C4 7C03282E */  lwzx    r0, r3, r5
/* 016328 8001B8C8 7FDE0214 */  add     r30, r30, r0
lbl_8001B8CC:
/* 01632C 8001B8CC 38840001 */  addi    r4, r4, 1
/* 016330 8001B8D0 2804000A */  cmplwi  r4, 0xa
/* 016334 8001B8D4 38A50004 */  addi    r5, r5, 4
/* 016338 8001B8D8 41820010 */  beq     lbl_8001B8E8
/* 01633C 8001B8DC 807C0474 */  lwz     r3, 0x474(r28)
/* 016340 8001B8E0 7C03282E */  lwzx    r0, r3, r5
/* 016344 8001B8E4 7FDE0214 */  add     r30, r30, r0
lbl_8001B8E8:
/* 016348 8001B8E8 38840001 */  addi    r4, r4, 1
/* 01634C 8001B8EC 2804000A */  cmplwi  r4, 0xa
/* 016350 8001B8F0 38A50004 */  addi    r5, r5, 4
/* 016354 8001B8F4 41820010 */  beq     lbl_8001B904
/* 016358 8001B8F8 807C0474 */  lwz     r3, 0x474(r28)
/* 01635C 8001B8FC 7C03282E */  lwzx    r0, r3, r5
/* 016360 8001B900 7FDE0214 */  add     r30, r30, r0
lbl_8001B904:
/* 016364 8001B904 38840001 */  addi    r4, r4, 1
/* 016368 8001B908 2804000A */  cmplwi  r4, 0xa
/* 01636C 8001B90C 38A50004 */  addi    r5, r5, 4
/* 016370 8001B910 41820010 */  beq     lbl_8001B920
/* 016374 8001B914 807C0474 */  lwz     r3, 0x474(r28)
/* 016378 8001B918 7C03282E */  lwzx    r0, r3, r5
/* 01637C 8001B91C 7FDE0214 */  add     r30, r30, r0
lbl_8001B920:
/* 016380 8001B920 38840001 */  addi    r4, r4, 1
/* 016384 8001B924 2804000A */  cmplwi  r4, 0xa
/* 016388 8001B928 38A50004 */  addi    r5, r5, 4
/* 01638C 8001B92C 41820010 */  beq     lbl_8001B93C
/* 016390 8001B930 807C0474 */  lwz     r3, 0x474(r28)
/* 016394 8001B934 7C03282E */  lwzx    r0, r3, r5
/* 016398 8001B938 7FDE0214 */  add     r30, r30, r0
lbl_8001B93C:
/* 01639C 8001B93C 38840001 */  addi    r4, r4, 1
/* 0163A0 8001B940 2804000A */  cmplwi  r4, 0xa
/* 0163A4 8001B944 38A50004 */  addi    r5, r5, 4
/* 0163A8 8001B948 41820010 */  beq     lbl_8001B958
/* 0163AC 8001B94C 807C0474 */  lwz     r3, 0x474(r28)
/* 0163B0 8001B950 7C03282E */  lwzx    r0, r3, r5
/* 0163B4 8001B954 7FDE0214 */  add     r30, r30, r0
lbl_8001B958:
/* 0163B8 8001B958 38A50004 */  addi    r5, r5, 4
/* 0163BC 8001B95C 38840001 */  addi    r4, r4, 1
/* 0163C0 8001B960 4200FF20 */  bdnz    lbl_8001B880
/* 0163C4 8001B964 2C1E0000 */  cmpwi   r30, 0
/* 0163C8 8001B968 40820130 */  bne     lbl_8001BA98
/* 0163CC 8001B96C 3BC00001 */  li      r30, 1
/* 0163D0 8001B970 48000128 */  b       lbl_8001BA98
lbl_8001B974:
/* 0163D4 8001B974 809C0474 */  lwz     r4, 0x474(r28)
/* 0163D8 8001B978 38612238 */  addi    r3, r1, 0x2238
/* 0163DC 8001B97C 38A00004 */  li      r5, 4
/* 0163E0 8001B980 3884106C */  addi    r4, r4, 0x106c
/* 0163E4 8001B984 4BFE9B41 */  bl      memcpy
/* 0163E8 8001B988 801F0000 */  lwz     r0, 0(r31)
/* 0163EC 8001B98C 2C000001 */  cmpwi   r0, 1
/* 0163F0 8001B990 40820108 */  bne     lbl_8001BA98
/* 0163F4 8001B994 38000100 */  li      r0, 0x100
/* 0163F8 8001B998 38800000 */  li      r4, 0
/* 0163FC 8001B99C 7C0903A6 */  mtctr   r0
/* 016400 8001B9A0 38A40000 */  addi    r5, r4, 0
/* 016404 8001B9A4 3BC00000 */  li      r30, 0
lbl_8001B9A8:
/* 016408 8001B9A8 2804041B */  cmplwi  r4, 0x41b
/* 01640C 8001B9AC 41820010 */  beq     lbl_8001B9BC
/* 016410 8001B9B0 807C0474 */  lwz     r3, 0x474(r28)
/* 016414 8001B9B4 7C03282E */  lwzx    r0, r3, r5
/* 016418 8001B9B8 7FDE0214 */  add     r30, r30, r0
lbl_8001B9BC:
/* 01641C 8001B9BC 38840001 */  addi    r4, r4, 1
/* 016420 8001B9C0 2804041B */  cmplwi  r4, 0x41b
/* 016424 8001B9C4 38A50004 */  addi    r5, r5, 4
/* 016428 8001B9C8 41820010 */  beq     lbl_8001B9D8
/* 01642C 8001B9CC 807C0474 */  lwz     r3, 0x474(r28)
/* 016430 8001B9D0 7C03282E */  lwzx    r0, r3, r5
/* 016434 8001B9D4 7FDE0214 */  add     r30, r30, r0
lbl_8001B9D8:
/* 016438 8001B9D8 38840001 */  addi    r4, r4, 1
/* 01643C 8001B9DC 2804041B */  cmplwi  r4, 0x41b
/* 016440 8001B9E0 38A50004 */  addi    r5, r5, 4
/* 016444 8001B9E4 41820010 */  beq     lbl_8001B9F4
/* 016448 8001B9E8 807C0474 */  lwz     r3, 0x474(r28)
/* 01644C 8001B9EC 7C03282E */  lwzx    r0, r3, r5
/* 016450 8001B9F0 7FDE0214 */  add     r30, r30, r0
lbl_8001B9F4:
/* 016454 8001B9F4 38840001 */  addi    r4, r4, 1
/* 016458 8001B9F8 2804041B */  cmplwi  r4, 0x41b
/* 01645C 8001B9FC 38A50004 */  addi    r5, r5, 4
/* 016460 8001BA00 41820010 */  beq     lbl_8001BA10
/* 016464 8001BA04 807C0474 */  lwz     r3, 0x474(r28)
/* 016468 8001BA08 7C03282E */  lwzx    r0, r3, r5
/* 01646C 8001BA0C 7FDE0214 */  add     r30, r30, r0
lbl_8001BA10:
/* 016470 8001BA10 38840001 */  addi    r4, r4, 1
/* 016474 8001BA14 2804041B */  cmplwi  r4, 0x41b
/* 016478 8001BA18 38A50004 */  addi    r5, r5, 4
/* 01647C 8001BA1C 41820010 */  beq     lbl_8001BA2C
/* 016480 8001BA20 807C0474 */  lwz     r3, 0x474(r28)
/* 016484 8001BA24 7C03282E */  lwzx    r0, r3, r5
/* 016488 8001BA28 7FDE0214 */  add     r30, r30, r0
lbl_8001BA2C:
/* 01648C 8001BA2C 38840001 */  addi    r4, r4, 1
/* 016490 8001BA30 2804041B */  cmplwi  r4, 0x41b
/* 016494 8001BA34 38A50004 */  addi    r5, r5, 4
/* 016498 8001BA38 41820010 */  beq     lbl_8001BA48
/* 01649C 8001BA3C 807C0474 */  lwz     r3, 0x474(r28)
/* 0164A0 8001BA40 7C03282E */  lwzx    r0, r3, r5
/* 0164A4 8001BA44 7FDE0214 */  add     r30, r30, r0
lbl_8001BA48:
/* 0164A8 8001BA48 38840001 */  addi    r4, r4, 1
/* 0164AC 8001BA4C 2804041B */  cmplwi  r4, 0x41b
/* 0164B0 8001BA50 38A50004 */  addi    r5, r5, 4
/* 0164B4 8001BA54 41820010 */  beq     lbl_8001BA64
/* 0164B8 8001BA58 807C0474 */  lwz     r3, 0x474(r28)
/* 0164BC 8001BA5C 7C03282E */  lwzx    r0, r3, r5
/* 0164C0 8001BA60 7FDE0214 */  add     r30, r30, r0
lbl_8001BA64:
/* 0164C4 8001BA64 38840001 */  addi    r4, r4, 1
/* 0164C8 8001BA68 2804041B */  cmplwi  r4, 0x41b
/* 0164CC 8001BA6C 38A50004 */  addi    r5, r5, 4
/* 0164D0 8001BA70 41820010 */  beq     lbl_8001BA80
/* 0164D4 8001BA74 807C0474 */  lwz     r3, 0x474(r28)
/* 0164D8 8001BA78 7C03282E */  lwzx    r0, r3, r5
/* 0164DC 8001BA7C 7FDE0214 */  add     r30, r30, r0
lbl_8001BA80:
/* 0164E0 8001BA80 38A50004 */  addi    r5, r5, 4
/* 0164E4 8001BA84 38840001 */  addi    r4, r4, 1
/* 0164E8 8001BA88 4200FF20 */  bdnz    lbl_8001B9A8
/* 0164EC 8001BA8C 2C1E0000 */  cmpwi   r30, 0
/* 0164F0 8001BA90 40820008 */  bne     lbl_8001BA98
/* 0164F4 8001BA94 3BC00001 */  li      r30, 1
lbl_8001BA98:
/* 0164F8 8001BA98 80012238 */  lwz     r0, 0x2238(r1)
/* 0164FC 8001BA9C 7C00F000 */  cmpw    r0, r30
/* 016500 8001BAA0 41820024 */  beq     lbl_8001BAC4
/* 016504 8001BAA4 38000012 */  li      r0, 0x12
/* 016508 8001BAA8 901C035C */  stw     r0, 0x35c(r28)
/* 01650C 8001BAAC 38810238 */  addi    r4, r1, 0x238
/* 016510 8001BAB0 38A02000 */  li      r5, 0x2000
/* 016514 8001BAB4 807C0474 */  lwz     r3, 0x474(r28)
/* 016518 8001BAB8 4BFE9A0D */  bl      memcpy
/* 01651C 8001BABC 38600000 */  li      r3, 0
/* 016520 8001BAC0 48000140 */  b       lbl_8001BC00
lbl_8001BAC4:
/* 016524 8001BAC4 3860002A */  li      r3, 0x2a
/* 016528 8001BAC8 4BFF1729 */  bl      simulatorPrepareMessage
/* 01652C 8001BACC 801F0000 */  lwz     r0, 0(r31)
/* 016530 8001BAD0 837C0474 */  lwz     r27, 0x474(r28)
/* 016534 8001BAD4 2C000001 */  cmpwi   r0, 1
/* 016538 8001BAD8 40820088 */  bne     lbl_8001BB60
/* 01653C 8001BADC 387B0000 */  addi    r3, r27, 0
/* 016540 8001BAE0 38802000 */  li      r4, 0x2000
/* 016544 8001BAE4 48081CC9 */  bl      DCStoreRange
/* 016548 8001BAE8 389B0000 */  addi    r4, r27, 0
/* 01654C 8001BAEC 387C0348 */  addi    r3, r28, 0x348
/* 016550 8001BAF0 57A66824 */  slwi    r6, r29, 0xd
/* 016554 8001BAF4 38A02000 */  li      r5, 0x2000
/* 016558 8001BAF8 38E00000 */  li      r7, 0
/* 01655C 8001BAFC 480A5281 */  bl      CARDWriteAsync
/* 016560 8001BB00 38830000 */  addi    r4, r3, 0
/* 016564 8001BB04 387C0000 */  addi    r3, r28, 0
/* 016568 8001BB08 48000799 */  bl      mcardGCErrorHandler
/* 01656C 8001BB0C 2C030001 */  cmpwi   r3, 1
/* 016570 8001BB10 4182000C */  beq     lbl_8001BB1C
/* 016574 8001BB14 38000000 */  li      r0, 0
/* 016578 8001BB18 4800004C */  b       lbl_8001BB64
lbl_8001BB1C:
/* 01657C 8001BB1C 38002000 */  li      r0, 0x2000
/* 016580 8001BB20 3C608001 */  lis     r3, simulatorMCardPollDrawBar@ha
/* 016584 8001BB24 901C036C */  stw     r0, 0x36c(r28)
/* 016588 8001BB28 38038A14 */  addi    r0, r3, simulatorMCardPollDrawBar@l
/* 01658C 8001BB2C 901C0364 */  stw     r0, 0x364(r28)
/* 016590 8001BB30 807C0360 */  lwz     r3, 0x360(r28)
/* 016594 8001BB34 480A19ED */  bl      CARDGetXferredBytes
/* 016598 8001BB38 907C0368 */  stw     r3, 0x368(r28)
/* 01659C 8001BB3C 7F83E378 */  mr      r3, r28
/* 0165A0 8001BB40 4BFFF629 */  bl      mcardPoll
/* 0165A4 8001BB44 2C030001 */  cmpwi   r3, 1
/* 0165A8 8001BB48 41820010 */  beq     lbl_8001BB58
/* 0165AC 8001BB4C 38000000 */  li      r0, 0
/* 0165B0 8001BB50 901C0364 */  stw     r0, 0x364(r28)
/* 0165B4 8001BB54 48000010 */  b       lbl_8001BB64
lbl_8001BB58:
/* 0165B8 8001BB58 38000000 */  li      r0, 0
/* 0165BC 8001BB5C 901C0364 */  stw     r0, 0x364(r28)
lbl_8001BB60:
/* 0165C0 8001BB60 38000001 */  li      r0, 1
lbl_8001BB64:
/* 0165C4 8001BB64 2C000000 */  cmpwi   r0, 0
/* 0165C8 8001BB68 4082001C */  bne     lbl_8001BB84
/* 0165CC 8001BB6C 807C0474 */  lwz     r3, 0x474(r28)
/* 0165D0 8001BB70 38810238 */  addi    r4, r1, 0x238
/* 0165D4 8001BB74 38A02000 */  li      r5, 0x2000
/* 0165D8 8001BB78 4BFE994D */  bl      memcpy
/* 0165DC 8001BB7C 38600000 */  li      r3, 0
/* 0165E0 8001BB80 48000080 */  b       lbl_8001BC00
lbl_8001BB84:
/* 0165E4 8001BB84 2C1D0000 */  cmpwi   r29, 0
/* 0165E8 8001BB88 40820074 */  bne     lbl_8001BBFC
/* 0165EC 8001BB8C 801C0470 */  lwz     r0, 0x470(r28)
/* 0165F0 8001BB90 2C000001 */  cmpwi   r0, 1
/* 0165F4 8001BB94 40820068 */  bne     lbl_8001BBFC
/* 0165F8 8001BB98 38810010 */  addi    r4, r1, 0x10
/* 0165FC 8001BB9C 7C802E70 */  srawi   r0, r4, 5
/* 016600 8001BBA0 7C000194 */  addze   r0, r0
/* 016604 8001BBA4 54002834 */  slwi    r0, r0, 5
/* 016608 8001BBA8 7C002010 */  subfc   r0, r0, r4
/* 01660C 8001BBAC 20600020 */  subfic  r3, r0, 0x20
/* 016610 8001BBB0 7C602E70 */  srawi   r0, r3, 5
/* 016614 8001BBB4 7C000194 */  addze   r0, r0
/* 016618 8001BBB8 54002834 */  slwi    r0, r0, 5
/* 01661C 8001BBBC 7C001810 */  subfc   r0, r0, r3
/* 016620 8001BBC0 7F640214 */  add     r27, r4, r0
/* 016624 8001BBC4 389B0000 */  addi    r4, r27, 0
/* 016628 8001BBC8 387C0348 */  addi    r3, r28, 0x348
/* 01662C 8001BBCC 38A00200 */  li      r5, 0x200
/* 016630 8001BBD0 38C00000 */  li      r6, 0
/* 016634 8001BBD4 480A4F41 */  bl      CARDRead
/* 016638 8001BBD8 38830000 */  addi    r4, r3, 0
/* 01663C 8001BBDC 387C0000 */  addi    r3, r28, 0
/* 016640 8001BBE0 480006C1 */  bl      mcardGCErrorHandler
/* 016644 8001BBE4 2C030001 */  cmpwi   r3, 1
/* 016648 8001BBE8 40820014 */  bne     lbl_8001BBFC
/* 01664C 8001BBEC 389B0000 */  addi    r4, r27, 0
/* 016650 8001BBF0 387C0320 */  addi    r3, r28, 0x320
/* 016654 8001BBF4 38A00028 */  li      r5, 0x28
/* 016658 8001BBF8 4BFE98CD */  bl      memcpy
lbl_8001BBFC:
/* 01665C 8001BBFC 38600001 */  li      r3, 1
lbl_8001BC00:
/* 016660 8001BC00 BB612244 */  lmw     r27, 0x2244(r1)
/* 016664 8001BC04 8001225C */  lwz     r0, 0x225c(r1)
/* 016668 8001BC08 38212258 */  addi    r1, r1, 0x2258
/* 01666C 8001BC0C 7C0803A6 */  mtlr    r0
/* 016670 8001BC10 4E800020 */  blr     
